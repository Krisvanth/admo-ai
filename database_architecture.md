# Admo AI - Database Architecture Plan (MongoDB)

## 1. Architecture Strategy: Multi-Tenancy
For an MVP (and even scaling up), it is highly recommended to use a **Single Database** approach where every document contains a `schoolId` field.
*   **Why?** Easier to maintain, migrate, and backup than managing 100s of separate databases for 100 schools.
*   **Isolation:** We ensure data isolation at the API level (always filtering by `req.user.schoolId`).

## 2. Core Collections
Here is the proposed schema structure to support all current features (Dashboard, Attendance, Fees, Exams, AI Tools).

### A. Organization & Auth
1.  **`schools`**
    *   *Purpose:* Stores school profile, global settings, and subscription status.
    *   *Fields:* `name`, `address`, `contact`, `settings` (theme, logo), `subscriptionPlan`.
2.  **`users`**
    *   *Purpose:* Authentication for Principals, Teachers, and Admins.
    *   *Fields:* `name`, `email`, `passwordHash`, `role` (principal/teacher), `schoolId`, `assignedClasses` (for teachers).

### B. Student Management
3.  **`students`**
    *   *Purpose:* The core database of students.
    *   *Fields:* `name`, `rollNo`, `class`, `section`, `parentName`, `parentPhone`, `schoolId`.
4.  **`classes`** (Optional but recommended for structure)
    *   *Purpose:* Define class hierarchy and class teachers.
    *   *Fields:* `grade` (10), `section` (A), `classTeacherId`, `schoolId`.

### C. Academic & Operations
5.  **`attendance`**
    *   *Purpose:* Daily attendance logs.
    *   *Fields:* `date`, `class`, `section`, `absentStudentIds` (Array of IDs), `markedBy` (UserId), `schoolId`.
6.  **`fees`**
    *   *Purpose:* Fee tracking and reminders.
    *   *Fields:* `studentId`, `amountDue`, `dueDate`, `status` (Paid/Pending/Overdue), `remindersSentCount`, `schoolId`.
7.  **`timetables`**
    *   *Purpose:* Class schedules.
    *   *Fields:* `class`, `section`, `day`, `periods` (Array of objects: time, subject, teacherId), `schoolId`.

### D. Exams & Results
8.  **`exams`**
    *   *Purpose:* Exam schedules and metadata.
    *   *Fields:* `name` (Half Yearly), `startDate`, `endDate`, `classesInvolved`, `status` (Draft/Published), `schoolId`.
9.  **`marks`**
    *   *Purpose:* Student scores.
    *   *Fields:* `examId`, `studentId`, `subject`, `score`, `maxMarks`, `schoolId`.

### E. AI & Communication
10. **`communications`**
    *   *Purpose:* Log of all messages sent (Broadcasts).
    *   *Fields:* `type` (WhatsApp/SMS), `recipientCount`, `content`, `status`, `sentAt`, `schoolId`.
11. **`ai_resources`**
    *   *Purpose:* Saved content generated by Teacher Assistant.
    *   *Fields:* `type` (Homework/LessonPlan), `content`, `generatedBy`, `createdAt`, `schoolId`.
12. **`parent_queries`**
    *   *Purpose:* Logs for the Parent Query Bot.
    *   *Fields:* `parentId`, `studentId`, `query`, `aiResponse`, `status` (Resolved/Escalated), `timestamp`, `schoolId`.

## 3. Technology Stack for Backend
*   **Runtime:** Node.js
*   **Framework:** Express.js
*   **Database:** MongoDB (via Mongoose ODM)
*   **Authentication:** JWT (JSON Web Tokens)

## 4. Next Steps
1.  Initialize a backend server (e.g., in a `server/` directory).
2.  Set up Mongoose connection.
3.  Create Schema models for the collections above.
4.  Create API endpoints to replace the hardcoded data in the React frontend.
